---
import BaseLayout from '../../layouts/BaseLayout.astro';
---

<BaseLayout title="Prompt och kontext">
  <div class="max-w-6xl mx-auto px-4 py-12">
    <!-- Header -->
    <section class="mb-12">
      <div class="flex items-center gap-4 mb-6">
        <a href="/verktyg" class="text-muted-foreground hover:text-primary transition-colors">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
          </svg>
        </a>
        <h1 class="text-3xl md:text-4xl font-bold font-sans">Prompt och kontext</h1>
      </div>
            <p class="text-lg text-muted-foreground font-sans max-w-3xl">
        Ett verktyg f칬r att bygga b칛ttre prompter genom att tydligt separera <b>instruktion (prompt)</b> fr친n <b>information (kontext)</b>. Genom att ge din AI tydliga roller, uppgifter och bakgrundsinformation f친r du mer exakta och anv칛ndbara svar.
      </p>
    </section>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
      <!-- Left Side - Instructions & Guidance -->
      <div class="space-y-6 lg:col-span-1">
        <!-- Template Selection -->
        <div class="rounded-lg border bg-card p-6">
          <h2 class="text-xl font-semibold mb-4 font-sans flex items-center gap-2">
            <i class="fas fa-star text-primary"></i>
            Visa exempel
          </h2>
          
          <button id="clear-btn" class="w-full text-left p-3 mb-4 rounded-lg border border-dashed hover:bg-accent transition-colors flex items-center gap-2 text-sm text-muted-foreground">
            <i class="fas fa-times-circle"></i>
            Rensa & b칬rja p친 ny
          </button>
          <div class="space-y-2">
             <button 
              data-example="practice-exercises"
              class="example-btn w-full text-left p-3 rounded-lg border hover:bg-accent transition-colors"
            >
              <div class="font-medium text-sm">游뱢 칐vningsuppgifter (Matematik 3b)</div>
              <div class="text-xs text-muted-foreground mt-1">Skapa uppgifter baserat p친 kursplan och NP</div>
            </button>

            <button 
              data-example="new-exam-version"
              class="example-btn w-full text-left p-3 rounded-lg border hover:bg-accent transition-colors"
            >
              <div class="font-medium text-sm">游닇 Ny version av prov (Milj칬- och energikunskap)</div>
              <div class="text-xs text-muted-foreground mt-1">Iterera och f칬rb칛ttra ett befintligt prov</div>
            </button>

            <button 
              data-example="update-course-content"
              class="example-btn w-full text-left p-3 rounded-lg border hover:bg-accent transition-colors"
            >
              <div class="font-medium text-sm">游댃 Uppdatera kursinneh친ll (Biologi 1)</div>
              <div class="text-xs text-muted-foreground mt-1">Anpassa material fr친n GY11 till GY25</div>
            </button>
          </div>
        </div>

        <!-- Process Steps -->
        <div class="rounded-lg border bg-card p-6">
          <h3 class="text-lg font-semibold mb-4 font-sans flex items-center gap-2">
            <i class="fas fa-shoe-prints text-primary"></i>
            S친 h칛r g칬r du
          </h3>
          
          <div class="space-y-3">
            <div class="flex items-start gap-3 text-sm">
              <div class="w-6 h-6 rounded-full bg-primary text-primary-foreground flex items-center justify-center text-xs font-bold mt-0.5 shrink-0">1</div>
              <div>
                <div class="font-medium text-foreground">B칬rja fr친n grunden</div>
                <div class="text-muted-foreground text-xs">Fyll i f칛lten till h칬ger f칬r att bygga din egen prompt.</div>
              </div>
            </div>
            <div class="flex items-start gap-3 text-sm">
              <div class="w-6 h-6 rounded-full bg-primary text-primary-foreground flex items-center justify-center text-xs font-bold mt-0.5 shrink-0">2</div>
              <div>
                <div class="font-medium text-foreground">L친t dig inspireras</div>
                <div class="text-muted-foreground text-xs">Klicka p친 ett exempel f칬r att se en komplett, verklig prompt.</div>
              </div>
            </div>
            <div class="flex items-start gap-3 text-sm">
              <div class="w-6 h-6 rounded-full bg-primary text-primary-foreground flex items-center justify-center text-xs font-bold mt-0.5 shrink-0">3</div>
              <div>
                <div class="font-medium text-foreground">Kopiera & anv칛nd</div>
                <div class="text-muted-foreground text-xs">Anv칛nd prompten i t.ex. ChatGPT, Gemini eller Claude.</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Tips -->
        <div class="rounded-lg border bg-gradient-to-br from-primary/5 to-accent/5 p-6">
          <h3 class="text-lg font-semibold mb-3 font-sans flex items-center gap-2">
            <i class="fas fa-lightbulb text-primary"></i>
            Tips f칬r b칛ttre resultat
          </h3>
          <ul class="space-y-3 text-sm text-muted-foreground font-sans">
            <li class="flex items-start gap-3"><span class="text-primary font-bold">1.</span><div><b>Ge kontext.</b> Ju mer information (text, l칛nkar, filer) AI:n f친r, desto b칛ttre blir resultatet.</div></li>
            <li class="flex items-start gap-3"><span class="text-primary font-bold">2.</span><div><b>L칛nka till kursplaner.</b> Anv칛nd <a href="https://gy25.se" target="_blank" class="text-primary hover:underline">gy25.se</a> f칬r att ge AI:n exakta styrdokument att f칬lja.</div></li>
            <li class="flex items-start gap-3"><span class="text-primary font-bold">3.</span><div><b>Be AI:n att fr친ga.</b> L칛gg till en instruktion som "Fr친ga om n친got 칛r oklart" f칬r att undvika missf칬rst친nd och f친 b칛ttre svar.</div></li>
          </ul>
        </div>
      </div>

      <!-- Right Side - Input Forms & Output -->
      <div class="space-y-6 lg:col-span-2">
        <!-- Input Form -->
        <div class="rounded-lg border bg-card p-6">
          <div class="flex items-center justify-between mb-6">
            <h2 class="text-xl font-semibold font-sans">Komponenter</h2>
            <div class="flex items-center gap-2 text-sm text-muted-foreground">
              <span id="selected-example">Ny</span>
            </div>
          </div>
          
          <div class="space-y-4">
            <div>
              <label class="block text-sm font-semibold mb-2 font-sans">Roll & Expertis</label>
              <textarea id="role-input" placeholder="Du 칛r en erfaren gymnasiel칛rare i..." class="w-full p-3 border border-input rounded-lg bg-background text-foreground font-sans h-28 resize-none focus:ring-2 focus:ring-primary/20 focus:border-primary transition-colors"></textarea>
            </div>

            <div>
              <label class="block text-sm font-semibold mb-2 font-sans">Uppgift</label>
              <textarea id="task-input" placeholder="Skapa en lektionsplan f칬r..." class="w-full p-3 border border-input rounded-lg bg-background text-foreground font-sans h-28 resize-none focus:ring-2 focus:ring-primary/20 focus:border-primary transition-colors"></textarea>
            </div>

            <div>
              <label class="block text-sm font-semibold mb-2 font-sans">Kontext & Bakgrund</label>
              <textarea id="context-input" placeholder="Eleverna 칛r i 친rskurs 2 p친 naturvetenskapsprogrammet..." class="w-full p-3 border border-input rounded-lg bg-background text-foreground font-sans h-32 resize-none focus:ring-2 focus:ring-primary/20 focus:border-primary transition-colors"></textarea>
            </div>

            <div>
              <label class="block text-sm font-semibold mb-2 font-sans">Format & Struktur</label>
              <textarea id="format-input" placeholder="Svara i punktform med tydliga rubriker..." class="w-full p-3 border border-input rounded-lg bg-background text-foreground font-sans h-28 resize-none focus:ring-2 focus:ring-primary/20 focus:border-primary transition-colors"></textarea>
            </div>

            <div>
              <label class="block text-sm font-semibold mb-2 font-sans">Exempel <span class="text-xs text-muted-foreground font-normal">(valfritt)</span></label>
              <textarea id="examples-input" placeholder="Exempel p친 칬nskad output..." class="w-full p-3 border border-input rounded-lg bg-background text-foreground font-sans h-28 resize-none focus:ring-2 focus:ring-accent/20 focus:border-accent transition-colors"></textarea>
            </div>

            <div>
              <label class="block text-sm font-semibold mb-2 font-sans">Begr칛nsningar & Krav</label>
              <textarea id="constraints-input" placeholder="Anpassa till svenska f칬rh친llanden, f칬lj Skolverkets riktlinjer..." class="w-full p-3 border border-input rounded-lg bg-background text-foreground font-sans h-28 resize-none focus:ring-2 focus:ring-primary/20 focus:border-primary transition-colors"></textarea>
            </div>
          </div>
        </div>

        <!-- Output Section -->
        <div class="rounded-lg border bg-card p-6">
          <div class="flex items-center justify-between mb-4">
            <h2 class="text-xl font-semibold font-sans flex items-center gap-2">
              <i class="fas fa-file-alt text-primary"></i>
              Genererad prompt
            </h2>
            <button id="copy-btn" class="bg-secondary text-secondary-foreground hover:bg-secondary/80 px-3 py-1.5 rounded-lg font-medium transition-colors flex items-center gap-2 text-sm">
              <span id="copy-default-icon"><i class="fas fa-copy"></i></span>
              <span id="copy-success-icon" class="hidden"><i class="fas fa-check text-green-500"></i></span>
              <span id="copy-text">Kopiera</span>
            </button>
          </div>
          
          <div id="output-area" class="w-full p-4 border border-input rounded-lg bg-muted/30 text-foreground font-mono text-sm min-h-80 whitespace-pre-wrap leading-relaxed">V칛lj en mall och fyll i f칛lten f칬r att generera din strukturerade AI-prompt...</div>
        </div>
      </div>
    </div>

    <!-- Sources Section -->
    <section class="mt-16 pt-8 border-t">
      <h2 class="text-2xl font-bold font-sans mb-4">K칛llor & Inspiration</h2>
      <p class="text-muted-foreground mb-6 max-w-2xl">Verktyget och konceptet med strukturerade prompter 칛r inspirerat av f칬ljande resurser. Utforska dem f칬r att f칬rdjupa din f칬rst친else f칬r "Context Engineering".</p>
      <ul class="space-y-4 text-muted-foreground">
        <li class="flex items-start gap-3">
          <i class="fas fa-book text-primary mt-1"></i>
          <div>
            <a href="https://github.com/davidkimai/context-engineering" target="_blank" rel="noopener noreferrer" class="font-medium text-foreground hover:text-primary transition-colors">
              Context Engineering: Beyond Prompt Engineering
            </a>
            <p class="text-sm">En guide p친 GitHub som utforskar principerna bakom Context Engineering.</p>
          </div>
        </li>
        <li class="flex items-start gap-3">
          <i class="fas fa-external-link-alt text-primary mt-1"></i>
          <div>
            <a href="https://context.addy.ie/" target="_blank" rel="noopener noreferrer" class="font-medium text-foreground hover:text-primary transition-colors">
              Context Buddy
            </a>
            <p class="text-sm">Ett liknande verktyg som varit en stor inspirationsk칛lla f칬r detta projekt.</p>
          </div>
        </li>
        <li class="flex items-start gap-3">
          <i class="fab fa-google text-primary mt-1"></i>
          <div>
            <a href="https://docs.google.com/presentation/d/1MTyP-BBusYw2rHKE_lQ2QVDA7uT7ngYaGfBy9HypQdY/edit" target="_blank" rel-="noopener noreferrer" class="font-medium text-foreground hover:text-primary transition-colors">
              100+ ways to use Gemini in Education
            </a>
            <p class="text-sm">En guide f칬r att hj칛lpa l칛rare och personal att komma ig친ng med Googles AI-verktyg som Gemini for Education, NotebookLM och Gemini i Classroom.</p>
          </div>
        </li>
      </ul>
    </section>

  </div>

  <script>
    type Template = {
      role: string;
      task: string;
      context: string;
      format: string;
      examples: string;
      constraints: string;
    };
    type ExampleKey = 'practice-exercises' | 'new-exam-version' | 'update-course-content';

    const examples: Record<ExampleKey, Template> = {
      'practice-exercises': {
        role: 'Du 칛r en expert p친 provkonstruktion och kursplanering f칬r den svenska gymnasieskolan, med djup kunskap om Matematik 3b och l칛roplanen GY25.',
        task: 'Analysera de uppladdade gamla nationella proven mot det centrala inneh친llet i kursen. Skapa d칛refter ett material med 칬vningsuppgifter som liknar uppgifterna p친 de nationella proven och som specifikt testar det angivna omr친det.',
        context: 'Jag har laddat upp alla gamla frisl칛ppta Nationella Prov i Matematik 3b, namngivna efter 친r och termin.\n\nNuvarande l칛roplan (GY25) finns h칛r: https://gy25.se/compare/matmat03b/mato1b00x\n\n칐vningsuppgifterna ska t칛cka f칬ljande begrepp och delar av det centrala inneh친llet f칬r algebraiska uttryck:\n- Begreppet rationella uttryck och hantering av dessa.\n- Begreppet gr칛nsv칛rde.\n- Begreppet polynom, egenskaper hos polynomfunktioner och metoder f칬r att l칬sa enklare polynomekvationer.\n\nEleverna har jobbat med f칬renkling av polynom och rationella uttryck, ekvationsl칬sning, samt unders칬kt gr칛nsv칛rden algebraiskt och i probleml칬sning.',
        format: 'L칛gg in alla uppgifter i ett .tex dokument f칬r snygg formatering och 칬kad l칛sbarhet.',
        examples: '',
        constraints: 'Basera uppgifterna p친 b친de de gamla nationella proven och det nuvarande centrala inneh친llet. Du kan 칛ven titta p친 bed칬mningskriterierna f칬r att se vad eleverna bed칬ms p친. Fr친ga om n친gon information 칛r otillr칛cklig. Detta material kommer att utg칬ra basen f칬r kommande prov i kursen.'
      },
      'new-exam-version': {
        role: 'Du 칛r en expert p친 provkonstruktion och kursplanering f칬r den svenska gymnasieskolan, med specialisering inom Milj칬- och energikunskap enligt GY11.',
        task: 'Skapa en ny version av ett befintligt prov. Du ska 친teranv칛nda vissa fr친gor, omarbeta andra och skapa n친gra helt nya fr친gor f칬r att s칛kerst칛lla en fr칛sch men likv칛rdig bed칬mning.',
        context: 'Kursen 칛r Milj칬- och energikunskap f칬r elever i 친rskurs 3 p친 naturvetenskapliga programmet. Provet ska baseras p친 mitt eget kursmaterial (filerna 1.md, 2.md, ..., 7.md) som jag laddat upp. L칛roplanen (GY11) finns h칛r: https://gy25.se/compare/h%C3%A5lmij0/milj1000x',
        format: 'Strukturera det nya provet med exakt 16 kryssfr친gor och 2 칬ppna frisvarsfr친gor. Konstruera det i en .tex fil som kan kompileras med en onlinekompilator.',
        examples: 'Det tidigare provet, `h친llbar.tex`, som jag ocks친 laddat upp, fungerar som en mall f칬r stil, struktur och sv친righetsgrad.',
        constraints: 'Det nya provet ska h친lla exakt samma sv친righetsgrad som det bifogade exempelprovet. Fr친ga om material saknas, inte kan l칛sas eller om 칬vriga instruktioner 칛r otydliga.'
      },
      'update-course-content': {
        role: 'Du 칛r en expert p친 kursutveckling f칬r den svenska gymnasieskolan, med specialkunskap inom Biologi 1 och 칬verg친ngen fr친n l칛roplanen GY11 till GY25.',
        task: 'Analysera mitt befintliga kursmaterial om genetik (skrivet f칬r GY11) och identifiera vad som beh칬ver anpassas f칬r GY25. F칬resl친 vad som kan tas bort, l칛ggas till eller kondenseras f칬r att m칬ta den nya l칛roplanen och g칬ra plats f칬r nya moment.',
        context: 'Jag har laddat upp mitt nuvarande material om genetik (`@/bio1/3`). Traditionellt har jag delat upp det i: Den genetiska koden, Celldelning och mutationer, Klassisk genetik, och Genteknik. \n\n- Nya l칛roplanen (GY25) f칬r Biologi 1: https://gy25.se/gy25/biog/biog1000x/ \n- J칛mf칬relse mellan GY11 och GY25: https://gy25.se/compare/biobio01/biog1000x',
        format: 'Ge mig en strukturerad analys med f칬ljande rubriker: 1. Gapanalys (vad saknas f칬r GY25?), 2. F칬rslag p친 anpassningar (vad b칬r 칛ndras/l칛ggas till?), 3. F칬rslag p친 kondensering (vad kan sl친s ihop eller kortas ner?).',
        examples: '',
        constraints: 'T칛nk efter ordentligt innan du svarar. Fr친ga om n친got 칛r otydligt, om du beh칬ver fler k칛llor, eller om du inte kan l칛sa de bifogade filerna.'
      }
    };

    const dom = {
      exampleBtns: document.querySelectorAll<HTMLButtonElement>('.example-btn'),
      clearBtn: document.getElementById('clear-btn') as HTMLButtonElement,
      selectedExampleSpan: document.getElementById('selected-example') as HTMLSpanElement,
      inputs: {
        role: document.getElementById('role-input') as HTMLTextAreaElement,
        task: document.getElementById('task-input') as HTMLTextAreaElement,
        context: document.getElementById('context-input') as HTMLTextAreaElement,
        format: document.getElementById('format-input') as HTMLTextAreaElement,
        examples: document.getElementById('examples-input') as HTMLTextAreaElement,
        constraints: document.getElementById('constraints-input') as HTMLTextAreaElement,
      },
      copyBtn: document.getElementById('copy-btn') as HTMLButtonElement,
      copyDefaultIcon: document.getElementById('copy-default-icon') as HTMLSpanElement,
      copySuccessIcon: document.getElementById('copy-success-icon') as HTMLSpanElement,
      copyText: document.getElementById('copy-text') as HTMLSpanElement,
      outputArea: document.getElementById('output-area') as HTMLDivElement,
    };

    function loadExample(exampleKey: ExampleKey) {
      const example = examples[exampleKey];
      if (!example) return;
      for (const key of Object.keys(example) as Array<keyof Template>) {
        if (dom.inputs[key]) {
          dom.inputs[key].value = example[key];
        }
      }
    }

    function clearFields() {
      for (const key in dom.inputs) {
        if (dom.inputs[key as keyof typeof dom.inputs]) {
          (dom.inputs[key as keyof typeof dom.inputs] as HTMLTextAreaElement).value = '';
        }
      }
      generatePrompt();
    }

    function generatePrompt() {
      const components = [
        { title: 'ROLL OCH EXPERTIS', value: dom.inputs.role?.value },
        { title: 'UPPGIFT', value: dom.inputs.task?.value },
        { title: 'KONTEXT OCH BAKGRUND', value: dom.inputs.context?.value },
        { title: 'FORMAT OCH STRUKTUR', value: dom.inputs.format?.value },
        { title: 'EXEMPEL', value: dom.inputs.examples?.value },
        { title: 'BEGR츿NSNINGAR OCH KRAV', value: dom.inputs.constraints?.value },
      ];
      const prompt = components
        .filter(c => c.value && c.value.trim())
        .map(c => `## ${c.title}\n${c.value.trim()}`)
        .join('\n\n');
      if (dom.outputArea) {
        dom.outputArea.textContent = prompt || 'V칛lj en mall och fyll i f칛lten f칬r att generera din strukturerade AI-prompt...';
      }
    }

    function copyToClipboard() {
      if (!dom.outputArea?.textContent || dom.outputArea.textContent.startsWith('V칛lj')) return;
      navigator.clipboard.writeText(dom.outputArea.textContent).then(() => {
        if(dom.copyDefaultIcon) dom.copyDefaultIcon.classList.add('hidden');
        if(dom.copySuccessIcon) dom.copySuccessIcon.classList.remove('hidden');
        if(dom.copyText) dom.copyText.textContent = 'Kopierat!';
        setTimeout(() => {
          if(dom.copyDefaultIcon) dom.copyDefaultIcon.classList.remove('hidden');
          if(dom.copySuccessIcon) dom.copySuccessIcon.classList.add('hidden');
          if(dom.copyText) dom.copyText.textContent = 'Kopiera';
        }, 2000);
      });
    }

    const exampleNames: Record<ExampleKey, string> = { 'practice-exercises': '칐vningsuppgifter (Matematik 3b)', 'new-exam-version': 'Ny version av prov (Milj칬- och energikunskap)', 'update-course-content': 'Uppdatera kursinneh친ll (Biologi 1)' };

    function updateActiveExample(exampleKey: ExampleKey | null) {
      dom.exampleBtns.forEach(btn => {
        btn.classList.remove('bg-primary/10', 'border-primary');
        btn.classList.add('border-border');
      });

      if (exampleKey) {
        const activeBtn = document.querySelector(`[data-example="${exampleKey}"]`);
        if (activeBtn) {
          activeBtn.classList.add('bg-primary/10', 'border-primary');
          activeBtn.classList.remove('border-border');
        }
        if (dom.selectedExampleSpan) {
          dom.selectedExampleSpan.textContent = exampleNames[exampleKey];
        }
      } else {
        if (dom.selectedExampleSpan) {
          dom.selectedExampleSpan.textContent = 'Ny';
        }
      }
    }

    dom.exampleBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        const exampleKey = btn.dataset.example as ExampleKey;
        if (exampleKey) {
          updateActiveExample(exampleKey);
          loadExample(exampleKey);
          generatePrompt();
        }
      });
    });

    if (dom.clearBtn) {
      dom.clearBtn.addEventListener('click', () => {
        updateActiveExample(null);
        clearFields();
      });
    }

    Object.values(dom.inputs).forEach(input => {
      if (input) {
        input.addEventListener('input', () => {
          updateActiveExample(null);
          generatePrompt();
        });
      }
    });

    if (dom.copyBtn) dom.copyBtn.addEventListener('click', copyToClipboard);

    clearFields();
    updateActiveExample(null);
    generatePrompt();
  </script>
</BaseLayout>
